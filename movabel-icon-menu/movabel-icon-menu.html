<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="jquery.js"></script>
</head>

<body>

    <div class="menu-icon" author="pcy"></div>

    <script>
        function movable_icon_menu(ele) {
            let eleCss = {
                position: 'absolute',
                top: '0',
                margin: "0",
                left: 'calc(100vw - 35px)',
                clip: 'rect(0,35px,70px,0)'
            }

            let qele = document.querySelector(ele);
            let canvas = document.createElement('canvas');
            qele.append(canvas);
            $(qele).css(eleCss);
            if (!canvas.getContext) return;
            canvas.width = "72";
            canvas.height = "72";
            let ctx = canvas.getContext('2d');

            function circle() {
                ctx.fillStyle = 'rgba(80,180,180,.5)'
                ctx.strokeStyle = "rgba(50,150,150,.8)";
                ctx.clearRect(0, 0, 70, 70);
                ctx.beginPath();
                ctx.arc(35, 35, 35, 35, Math.PI * 35);
                ctx.fill();
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(35, 35, 25, 25, Math.PI * 25);
                ctx.stroke();
                ctx.closePath();

                ctx.beginPath();
                ctx.arc(35, 35, 15, 15, Math.PI * 15);
                ctx.stroke();
                ctx.closePath();

            }
            circle();
            $(canvas).on('mousedown', function() {
                $(canvas).parent().css('clip', 'auto');
                $(document).on('mousemove.drag', function(e) {
                    $(canvas).parent().offset({
                        left: e.pageX - 35,
                        top: e.pageY - 35,
                    })
                }).on('mouseup', function() {
                    let ctx_X = $(canvas).parent().offset().left;
                    let doc_W = $(document).width();
                    if (doc_W / 2 >= ctx_X) {
                        $(canvas).parent().css({
                            left: '-35px'
                        })
                    } else {
                        $(canvas).parent().css({
                            left: 'calc(100vw - 35px)',
                            clip: 'rect(0,35px,70px,0)'
                        });
                    }
                    $(this).off('mousemove.drag')
                })
            })
        }

        movable_icon_menu('.menu-icon[author=pcy]');
    </script>
</body>

</html>